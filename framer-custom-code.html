<script>
// Fixed Framer resize listener - v4
(function() {
    console.log('Framer resize listener v4 initialized');
    
    let lastAppliedHeight = 0;
    let resizeQueue = [];
    
    function applyHeight(newHeight) {
        const iframes = document.querySelectorAll('iframe');
        
        iframes.forEach(iframe => {
            // Apply to all iframes containing your form
            if (iframe.src && (iframe.src.includes('localhost') || iframe.src.includes('your-domain') || !iframe.src)) {
                // Set height with important to override Framer defaults
                iframe.setAttribute('style', `height: ${newHeight}px !important; min-height: ${newHeight}px !important; max-height: none !important;`);
                
                // Also update parent containers
                let parent = iframe.parentElement;
                while (parent && parent !== document.body) {
                    if (parent.className && parent.className.includes('framer')) {
                        parent.style.minHeight = `${newHeight}px`;
                        parent.style.height = 'auto';
                        parent.style.maxHeight = 'none';
                        parent.style.overflow = 'visible';
                    }
                    parent = parent.parentElement;
                }
            }
        });
    }
    
    // Process resize messages
    window.addEventListener('message', function(e) {
        if (e.data && e.data.type === 'resize-embed') {
            const newHeight = parseInt(e.data.height);
            
            // Always apply the height to prevent cutoff
            console.log('Received height:', newHeight);
            lastAppliedHeight = newHeight;
            applyHeight(newHeight);
        }
    });
    
    // Force initial small height on load
    window.addEventListener('DOMContentLoaded', function() {
        setTimeout(() => {
            const iframes = document.querySelectorAll('iframe');
            iframes.forEach(iframe => {
                if (!iframe.classList.contains('sized')) {
                    iframe.classList.add('sized');
                    applyHeight(250); // Start small
                }
            });
        }, 100);
    });
})();
</script>

<style>
/* Critical iframe styling */
iframe {
    width: 100% !important;
    border: none !important;
    display: block !important;
    transition: height 0.3s ease !important;
    overflow: hidden !important;
}

/* Remove all Framer padding */
[data-framer-component-type="Embed"] {
    padding: 0 !important;
    margin: 0 !important;
    overflow: visible !important;
    height: auto !important;
    min-height: 0 !important;
}

/* Ensure parent containers can expand */
div:has(> iframe) {
    overflow: visible !important;
    height: auto !important;
    min-height: 0 !important;
}
</style>